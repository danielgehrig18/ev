100%|██████████| 40/40 [00:07<00:00,  5.07it/s]
Min Error  tensor(34.8177, device='cuda:0')
/home/dgehrig/Documents/projects/ev/ev/scripts/train.py:174: UserWarning: Anomaly Detection has been enabled. This mode will increase the runtime and should only be enabled for debugging.
  with torch.autograd.detect_anomaly(True):
  0%|          | 0/391 [00:00<?, ?it/s]/home/dgehrig/Documents/projects/ev/ev/scripts/train.py:80: FutureWarning: `torch.nn.utils.clip_grad_norm` is now deprecated in favor of `torch.nn.utils.clip_grad_norm_`.
  torch.nn.utils.clip_grad_norm(model.parameters(), max_norm=0.1)
  0%|          | 1/391 [00:04<27:03,  4.16s/it]/home/dgehrig/.mamba/envs/ev/lib/python3.11/site-packages/torch/autograd/graph.py:824: UserWarning: Error detected in BmmBackward0. Traceback of forward call that caused the error:
  File "/home/dgehrig/Documents/projects/ev/ev/scripts/train.py", line 175, in <module>
    error = train(train_loader, model, optimizer, log_every=10)
  File "/home/dgehrig/Documents/projects/ev/ev/scripts/train.py", line 71, in train
    Delta_T_pred = model(timestamps=samples["timestamps"],
  File "/home/dgehrig/.mamba/envs/ev/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1749, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/dgehrig/.mamba/envs/ev/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1855, in _call_impl
    return inner()
  File "/home/dgehrig/.mamba/envs/ev/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1803, in inner
    result = forward_call(*args, **kwargs)
  File "/home/dgehrig/Documents/projects/ev/ev/src/ev/models/network.py", line 63, in forward
    output = self.orthogonalize(output)
  File "/home/dgehrig/Documents/projects/ev/ev/src/ev/models/network.py", line 81, in orthogonalize
    r3 = torch.bmm(so3_hat_torch(r1), r2[...,None])[...,0]
 (Triggered internally at /pytorch/torch/csrc/autograd/python_anomaly_mode.cpp:122.)
  return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
  0%|          | 1/391 [00:05<32:44,  5.04s/it]
Traceback (most recent call last):
  File "/home/dgehrig/Documents/projects/ev/ev/scripts/train.py", line 175, in <module>
    error = train(train_loader, model, optimizer, log_every=10)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/dgehrig/Documents/projects/ev/ev/scripts/train.py", line 79, in train
    loss.backward()
  File "/home/dgehrig/.mamba/envs/ev/lib/python3.11/site-packages/torch/_tensor.py", line 648, in backward
    torch.autograd.backward(
  File "/home/dgehrig/.mamba/envs/ev/lib/python3.11/site-packages/torch/autograd/__init__.py", line 353, in backward
    _engine_run_backward(
  File "/home/dgehrig/.mamba/envs/ev/lib/python3.11/site-packages/torch/autograd/graph.py", line 824, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: Function 'BmmBackward0' returned nan values in its 1th output.
